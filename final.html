<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-07-17">

<title>Song Trends in 2023</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="final_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_files/libs/quarto-html/quarto.js"></script>
<script src="final_files/libs/quarto-html/popper.min.js"></script>
<script src="final_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="final_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="final_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="final_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="final_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="final_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="final_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="final_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="final_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="final_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="final_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Song Trends in 2023</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 17, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this analysis, we aim to explore and visualize the top songs based on their streaming numbers across different platforms. We will particularly focus on identifying the top 10 songs released in 2023 and comparing them with the overall top 10 songs by streams. This analysis is crucial for understanding trends in music popularity and how recent releases stack up against all-time hits.</p>
<p>First, we load the necessary libraries. We use <code>readr</code> for reading the dataset, <code>dplyr</code> for data manipulation, <code>ggplot2</code> for visualization, and <code>plotly</code> for creating interactive plots.</p>
<p>We filter the dataset to select the top 10 songs released in the year 2023. This helps us focus on the most popular recent releases.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>top_10_songs_released_2023 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="fu">filter</span>(released_year <span class="sc">==</span> <span class="dv">2023</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(streams)) <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">select</span>(track_name, artist_name, streams)</span>
<span id="cb1-6"><a href="#cb1-6"></a>top_10_songs_released_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["track_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["artist_name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["streams"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Flowers","2":"Miley Cyrus","3":"1316855716","_rn_":"1"},{"1":"Ella Baila Sola","2":"Eslabon Armado, Peso Pluma","3":"725980112","_rn_":"2"},{"1":"Shakira: Bzrp Music Sessions, Vol. 53","2":"Shakira, Bizarrap","3":"721975598","_rn_":"3"},{"1":"TQG","2":"Karol G, Shakira","3":"618990393","_rn_":"4"},{"1":"La Bebe - Remix","2":"Peso Pluma, Yng Lvcas","3":"553634067","_rn_":"5"},{"1":"Die For You - Remix","2":"Ariana Grande, The Weeknd","3":"518745108","_rn_":"6"},{"1":"un x100to","2":"Bad Bunny, Grupo Frontera","3":"505671438","_rn_":"7"},{"1":"Cupid - Twin Ver.","2":"Fifty Fifty","3":"496795686","_rn_":"8"},{"1":"PRC","2":"Natanael Cano, Peso Pluma","3":"436027885","_rn_":"9"},{"1":"OMG","2":"NewJeans","3":"430977451","_rn_":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Here, we select the overall top 10 songs by their number of streams. This gives us an insight into the most popular songs regardless of their release year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>top_10_songs_2023 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(streams)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">select</span>(track_name, released_year, artist_name, streams)</span>
<span id="cb2-5"><a href="#cb2-5"></a>top_10_songs_2023</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["track_name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["released_year"],"name":[2],"type":["int"],"align":["right"]},{"label":["artist_name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["streams"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Blinding Lights","2":"2019","3":"The Weeknd","4":"3703895074","_rn_":"1"},{"1":"Shape of You","2":"2017","3":"Ed Sheeran","4":"3562543890","_rn_":"2"},{"1":"Someone You Loved","2":"2018","3":"Lewis Capaldi","4":"2887241814","_rn_":"3"},{"1":"Dance Monkey","2":"2019","3":"Tones and I","4":"2864791672","_rn_":"4"},{"1":"Sunflower - Spider-Man: Into the Spider-Verse","2":"2018","3":"Post Malone, Swae Lee","4":"2808096550","_rn_":"5"},{"1":"One Dance","2":"2016","3":"Drake, WizKid, Kyla","4":"2713922350","_rn_":"6"},{"1":"STAY (with Justin Bieber)","2":"2021","3":"Justin Bieber, The Kid Laroi","4":"2665343922","_rn_":"7"},{"1":"Believer","2":"2017","3":"Imagine Dragons","4":"2594040133","_rn_":"8"},{"1":"Closer","2":"2016","3":"The Chainsmokers, Halsey","4":"2591224264","_rn_":"9"},{"1":"Starboy","2":"2016","3":"The Weeknd, Daft Punk","4":"2565529693","_rn_":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We combine the two datasets—top 10 songs released in 2023 and overall top 10 songs. This allows us to compare the two sets of songs in a single visualization. We use ggplot2 to create a base plot and then convert it to an interactive plot using plotly. The plot shows the top 10 songs by streams, distinguishing between songs released in 2023 and the overall top 10 songs. Hovering over a point displays the song name and artist name.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>top_10_songs_released_2023<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Released in 2023"</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>top_10_songs_2023<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Top 10 Overall"</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(top_10_songs_released_2023, top_10_songs_2023)</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>combined_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> <span class="fu">row_number</span>())</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> streams<span class="sc">/</span><span class="dv">100000</span>, <span class="at">group =</span> type, <span class="at">color =</span> type, <span class="at">linetype =</span> type, <span class="at">text =</span> <span class="fu">paste</span>(<span class="st">"Track Name:"</span>, track_name, <span class="st">"&lt;br&gt;Artist:"</span>, artist_name))) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Songs by Streams"</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>       <span class="at">x =</span> <span class="st">"Track Position"</span>,</span>
<span id="cb3-17"><a href="#cb3-17"></a>       <span class="at">y =</span> <span class="st">"Number of Streams"</span>,</span>
<span id="cb3-18"><a href="#cb3-18"></a>       <span class="at">color =</span> <span class="st">"Category"</span>,</span>
<span id="cb3-19"><a href="#cb3-19"></a>       <span class="at">linetype =</span> <span class="st">"Category"</span>) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb3-22"><a href="#cb3-22"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-22002f685c2731bbab9d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-22002f685c2731bbab9d">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10],"y":[13168.55716,7259.8011200000001,7219.7559799999999,6189.9039300000004,5536.3406699999996,5187.4510799999998,5056.7143800000003,4967.9568600000002,4360.2788499999997,4309.7745100000002],"text":["Track Name: Flowers <br>Artist: Miley Cyrus","Track Name: Ella Baila Sola <br>Artist: Eslabon Armado, Peso Pluma","Track Name: Shakira: Bzrp Music Sessions, Vol. 53 <br>Artist: Shakira, Bizarrap","Track Name: TQG <br>Artist: Karol G, Shakira","Track Name: La Bebe - Remix <br>Artist: Peso Pluma, Yng Lvcas","Track Name: Die For You - Remix <br>Artist: Ariana Grande, The Weeknd","Track Name: un x100to <br>Artist: Bad Bunny, Grupo Frontera","Track Name: Cupid - Twin Ver. <br>Artist: Fifty Fifty","Track Name: PRC <br>Artist: Natanael Cano, Peso Pluma","Track Name: OMG <br>Artist: NewJeans"],"type":"scatter","mode":"lines+markers","line":{"width":5.6692913385826778,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"Released in 2023","legendgroup":"Released in 2023","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":11.338582677165356,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"frame":null},{"x":[1,2,3,4,5,6,7,8,9,10],"y":[37038.95074,35625.438900000001,28872.418140000002,28647.916720000001,28080.965499999998,27139.2235,26653.43922,25940.401330000001,25912.24264,25655.29693],"text":["Track Name: Blinding Lights <br>Artist: The Weeknd","Track Name: Shape of You <br>Artist: Ed Sheeran","Track Name: Someone You Loved <br>Artist: Lewis Capaldi","Track Name: Dance Monkey <br>Artist: Tones and I","Track Name: Sunflower - Spider-Man: Into the Spider-Verse <br>Artist: Post Malone, Swae Lee","Track Name: One Dance <br>Artist: Drake, WizKid, Kyla","Track Name: STAY (with Justin Bieber) <br>Artist: Justin Bieber, The Kid Laroi","Track Name: Believer <br>Artist: Imagine Dragons","Track Name: Closer <br>Artist: The Chainsmokers, Halsey","Track Name: Starboy <br>Artist: The Weeknd, Daft Punk"],"type":"scatter","mode":"lines+markers","line":{"width":5.6692913385826778,"color":"rgba(0,191,196,1)","dash":"dash"},"hoveron":"points","name":"Top 10 Overall","legendgroup":"Top 10 Overall","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":11.338582677165356,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":42.22428554020037,"l":54.794520547945211},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Top 10 Songs by Streams","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.55000000000000004,10.449999999999999],"tickmode":"array","ticktext":["2.5","5.0","7.5","10.0"],"tickvals":[2.5,5,7.5,10],"categoryorder":"array","categoryarray":["2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Track Position","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2673.3156985000001,38675.409551500001],"tickmode":"array","ticktext":["10000","20000","30000"],"tickvals":[10000,20000,30000],"categoryorder":"array","categoryarray":["10000","20000","30000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of Streams","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Category","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"53404f3262fb":{"x":{},"y":{},"colour":{},"linetype":{},"text":{},"type":"scatter"},"534015131de3":{"x":{},"y":{},"colour":{},"linetype":{},"text":{}}},"cur_data":"53404f3262fb","visdat":{"53404f3262fb":["function (y) ","x"],"534015131de3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"spotify-2023.csv"</span>, <span class="at">encoding =</span> <span class="st">"latin1"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">mutate</span>(<span class="at">streams =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">""</span>, streams))) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Filter for top 10 songs</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>top_10_songs <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(streams)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Filter for next 10 songs</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>next_10_songs <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(streams)) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">slice</span>(<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co"># Combine the two datasets</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>top_10_songs<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Top 10"</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>next_10_songs<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Next 10"</span></span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(top_10_songs, next_10_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p_streams <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(track_name, <span class="sc">-</span>streams), <span class="at">y =</span> streams<span class="sc">/</span><span class="dv">1000000</span>, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Streaming Numbers for Top 10 and Next 10 Songs"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>       <span class="at">x =</span> <span class="st">"Track Name"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>       <span class="at">y =</span> <span class="st">"Number of Streams (in millions)"</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>       <span class="at">fill =</span> <span class="st">"Category"</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>audio_features <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">select</span>(track_name, type, <span class="at">danceability_ =</span> danceability_., <span class="at">valence_ =</span> valence_., <span class="at">energy_ =</span> energy_., <span class="at">acousticness_ =</span> acousticness_., <span class="at">instrumentalness_ =</span> instrumentalness_., <span class="at">liveness_ =</span> liveness_., <span class="at">speechiness_ =</span> speechiness_.) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">gather</span>(feature, value, <span class="sc">-</span>track_name, <span class="sc">-</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>p_features <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(audio_features, <span class="fu">aes</span>(<span class="at">x =</span> feature, <span class="at">y =</span> value, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Audio Features Comparison for Top 10 and Next 10 Songs"</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>       <span class="at">x =</span> <span class="st">"Audio Feature"</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>       <span class="at">y =</span> <span class="st">"Value"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>       <span class="at">fill =</span> <span class="st">"Category"</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># Convert to interactive plots</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="fu">ggplotly</span>(p_streams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-3785f2801c0954585e66" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3785f2801c0954585e66">{"x":{"data":[{"orientation":"v","width":[0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0],"x":[11,12,13,14,15,16,17,18,19,20],"y":[2559.529074,2557.975762,2513.1884930000001,2484.8129180000001,2420.4613380000001,2355.719893,2322.5801219999998,2303.0339730000001,2288.695111,2282.7714850000002],"text":["reorder(track_name, -streams): Perfect<br />streams/1e+06: 2559.529<br />type: Next 10","reorder(track_name, -streams): Heat Waves<br />streams/1e+06: 2557.976<br />type: Next 10","reorder(track_name, -streams): As It Was<br />streams/1e+06: 2513.188<br />type: Next 10","reorder(track_name, -streams): Seï¿½ï¿½o<br />streams/1e+06: 2484.813<br />type: Next 10","reorder(track_name, -streams): Say You Won't Let Go<br />streams/1e+06: 2420.461<br />type: Next 10","reorder(track_name, -streams): lovely - Bonus Track<br />streams/1e+06: 2355.720<br />type: Next 10","reorder(track_name, -streams): Watermelon Sugar<br />streams/1e+06: 2322.580<br />type: Next 10","reorder(track_name, -streams): Don't Start Now<br />streams/1e+06: 2303.034<br />type: Next 10","reorder(track_name, -streams): Lucid Dreams<br />streams/1e+06: 2288.695<br />type: Next 10","reorder(track_name, -streams): Sweater Weather<br />streams/1e+06: 2282.771<br />type: Next 10"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Next 10","legendgroup":"Next 10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10],"y":[3703.895074,3562.5438899999999,2887.241814,2864.7916719999998,2808.0965500000002,2713.9223499999998,2665.343922,2594.040133,2591.2242639999999,2565.529693],"text":["reorder(track_name, -streams): Blinding Lights<br />streams/1e+06: 3703.895<br />type: Top 10","reorder(track_name, -streams): Shape of You<br />streams/1e+06: 3562.544<br />type: Top 10","reorder(track_name, -streams): Someone You Loved<br />streams/1e+06: 2887.242<br />type: Top 10","reorder(track_name, -streams): Dance Monkey<br />streams/1e+06: 2864.792<br />type: Top 10","reorder(track_name, -streams): Sunflower - Spider-Man: Into the Spider-Verse<br />streams/1e+06: 2808.097<br />type: Top 10","reorder(track_name, -streams): One Dance<br />streams/1e+06: 2713.922<br />type: Top 10","reorder(track_name, -streams): STAY (with Justin Bieber)<br />streams/1e+06: 2665.344<br />type: Top 10","reorder(track_name, -streams): Believer<br />streams/1e+06: 2594.040<br />type: Top 10","reorder(track_name, -streams): Closer<br />streams/1e+06: 2591.224<br />type: Top 10","reorder(track_name, -streams): Starboy<br />streams/1e+06: 2565.530<br />type: Top 10"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Top 10","legendgroup":"Top 10","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":166.79642372920054,"l":48.949771689497723},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Streaming Numbers for Top 10 and Next 10 Songs","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,20.600000000000001],"tickmode":"array","ticktext":["Blinding Lights","Shape of You","Someone You Loved","Dance Monkey","Sunflower - Spider-Man: Into the Spider-Verse","One Dance","STAY (with Justin Bieber)","Believer","Closer","Starboy","Perfect","Heat Waves","As It Was","Seï¿½ï¿½o","Say You Won't Let Go","lovely - Bonus Track","Watermelon Sugar","Don't Start Now","Lucid Dreams","Sweater Weather"],"tickvals":[1,2,3,4.0000000000000009,5,6.0000000000000009,7,8,9,10,11,12.000000000000002,13,14.000000000000002,15,16,17,18,19,20],"categoryorder":"array","categoryarray":["Blinding Lights","Shape of You","Someone You Loved","Dance Monkey","Sunflower - Spider-Man: Into the Spider-Verse","One Dance","STAY (with Justin Bieber)","Believer","Closer","Starboy","Perfect","Heat Waves","As It Was","Seï¿½ï¿½o","Say You Won't Let Go","lovely - Bonus Track","Watermelon Sugar","Don't Start Now","Lucid Dreams","Sweater Weather"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Track Name","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-185.19475370000001,3889.0898277000001],"tickmode":"array","ticktext":["0","1000","2000","3000"],"tickvals":[0,1000.0000000000001,2000,3000],"categoryorder":"array","categoryarray":["0","1000","2000","3000"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Number of Streams (in millions)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Category","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"53407a647c1":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"53407a647c1","visdat":{"53407a647c1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplotly</span>(p_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-577f71dc3e3d4bebef8a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-577f71dc3e3d4bebef8a">{"x":{"data":[{"x":[2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6],"y":[60,76,52,76,40,35,55,79,44,61,17,53,66,77,45,12,56,68,22,41,45,53,73,52,56,30,82,79,48,81,16,44,34,4,69,93,12,1,38,5,0,0,0,0,0,0,0,0,0,2,11,9,31,8,9,10,34,10,33,10,2,9,6,3,5,3,5,8,24,3],"hoverinfo":"y","type":"box","fillcolor":"rgba(248,118,109,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Next 10","legendgroup":"Next 10","showlegend":true,"xaxis":"x","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7,7,7,7,7,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6],"y":[50,83,50,82,76,77,59,77,75,68,38,93,45,54,91,36,48,74,64,49,80,65,41,59,50,63,76,78,52,59,0,58,75,69,54,1,4,4,41,16,0,0,0,0,0,0,0,0,0,0,9,9,11,18,7,36,10,23,11,13,7,8,3,10,5,5,5,11,3,28],"hoverinfo":"y","type":"box","fillcolor":"rgba(0,191,196,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"},"size":5.6692913385826778},"line":{"color":"rgba(51,51,51,1)","width":1.8897637795275593},"name":"Top 10","legendgroup":"Top 10","showlegend":true,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":81.049506567535644,"l":37.260273972602747},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Audio Features Comparison for Top 10 and Next 10 Songs","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,7.5999999999999996],"tickmode":"array","ticktext":["acousticness_","danceability_","energy_","instrumentalness_","liveness_","speechiness_","valence_"],"tickvals":[1,2,3,4.0000000000000009,5,6,7],"categoryorder":"array","categoryarray":["acousticness_","danceability_","energy_","instrumentalness_","liveness_","speechiness_","valence_"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"Audio Feature","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.6500000000000004,97.650000000000006],"tickmode":"array","ticktext":["0","25","50","75"],"tickvals":[0,25,50.000000000000007,75],"categoryorder":"array","categoryarray":["0","25","50","75"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"Value","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"Category","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"53406ea7e37":{"x":{},"y":{},"fill":{},"type":"box"}},"cur_data":"53406ea7e37","visdat":{"53406ea7e37":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>